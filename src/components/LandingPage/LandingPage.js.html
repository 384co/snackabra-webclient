<!-- Generator: GNU source-highlight 3.1.9
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/* Copyright (c) 2021 Magnusson Institute, All Rights Reserved */</font></i>

import React<font color="#990000">,</font> <font color="#FF0000">{</font> useState <font color="#FF0000">}</font> from <font color="#FF0000">'react'</font><font color="#990000">;</font>
import <font color="#FF0000">'./LandingPage.css'</font><font color="#990000">;</font>
import <font color="#FF0000">{</font> useHistory <font color="#FF0000">}</font> from <font color="#FF0000">'react-router-dom'</font>
import <font color="#FF0000">{</font> JwModal <font color="#FF0000">}</font> from <font color="#FF0000">'../../containers/Modal/Modal'</font>
import edit_icon from <font color="#FF0000">'../../static/icons8-edit-24.png'</font>
import refresh_icon from <font color="#FF0000">'../../static/icons8-refresh-24.png'</font>
import download_icon from <font color="#FF0000">'../../static/download-file-square-line.png'</font>
import <font color="#FF0000">{</font> Trans <font color="#FF0000">}</font> from <font color="#FF0000">'@lingui/macro'</font>
import <font color="#990000">*</font> as utils from <font color="#FF0000">'../../utils/utils'</font><font color="#990000">;</font>

<b><font color="#0000FF">const</font></b> LandingPage <font color="#990000">=</font> <font color="#990000">(</font>props<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>

  let ROOM_SERVER <font color="#990000">=</font> <font color="#FF0000">"https://"</font> <font color="#990000">+</font> process<font color="#990000">.</font>env<font color="#990000">.</font>REACT_APP_ROOM_SERVER <font color="#990000">+</font> <font color="#FF0000">"/api/room/"</font>
  let STORAGE_SERVER <font color="#990000">=</font> <font color="#FF0000">"https://"</font> <font color="#990000">+</font> process<font color="#990000">.</font>env<font color="#990000">.</font>REACT_APP_STORAGE_SERVER <font color="#990000">+</font> <font color="#FF0000">"/api/v1/"</font>

  <b><font color="#0000FF">const</font></b> <font color="#990000">[</font>rooms<font color="#990000">,</font> setRooms<font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">useState</font></b><font color="#990000">(</font><font color="#FF0000">{</font> <font color="#990000">...</font>props<font color="#990000">.</font>rooms <font color="#FF0000">}</font><font color="#990000">);</font>
  <b><font color="#0000FF">const</font></b> <font color="#990000">[</font>renameRoom<font color="#990000">,</font> setRenameRoom<font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">useState</font></b><font color="#990000">(</font><font color="#FF0000">''</font><font color="#990000">);</font>
  <b><font color="#0000FF">const</font></b> history <font color="#990000">=</font> <b><font color="#000000">useHistory</font></b><font color="#990000">();</font>

  <b><font color="#0000FF">const</font></b> downloadFile <font color="#990000">=</font> <font color="#990000">(</font>text<font color="#990000">,</font> file<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
      let element <font color="#990000">=</font> document<font color="#990000">.</font><b><font color="#000000">createElement</font></b><font color="#990000">(</font><font color="#FF0000">'a'</font><font color="#990000">);</font>
      element<font color="#990000">.</font><b><font color="#000000">setAttribute</font></b><font color="#990000">(</font><font color="#FF0000">'href'</font><font color="#990000">,</font> <font color="#FF0000">'data:text/plain;charset=utf-8, '</font> <font color="#990000">+</font> <b><font color="#000000">encodeURIComponent</font></b><font color="#990000">(</font>text<font color="#990000">));</font>
      element<font color="#990000">.</font><b><font color="#000000">setAttribute</font></b><font color="#990000">(</font><font color="#FF0000">'download'</font><font color="#990000">,</font> file<font color="#990000">);</font>
      document<font color="#990000">.</font>body<font color="#990000">.</font><b><font color="#000000">appendChild</font></b><font color="#990000">(</font>element<font color="#990000">);</font>
      element<font color="#990000">.</font><b><font color="#000000">click</font></b><font color="#990000">();</font>
      document<font color="#990000">.</font>body<font color="#990000">.</font><b><font color="#000000">removeChild</font></b><font color="#990000">(</font>element<font color="#990000">);</font>
    <font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>error<font color="#990000">)</font> <font color="#FF0000">{</font>
      console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>error<font color="#990000">);</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> importFile <font color="#990000">=</font> <font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <b><font color="#0000FF">const</font></b> reader <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">FileReader</font></b><font color="#990000">()</font>
    reader<font color="#990000">.</font>onload <font color="#990000">=</font> event <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
      <b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">const</font></b> keys <font color="#990000">=</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>event<font color="#990000">.</font>target<font color="#990000">.</font>result<font color="#990000">);</font>
        <b><font color="#000000">importKeysToLS</font></b><font color="#990000">(</font>keys<font color="#990000">);</font>
        document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_import_ta"</font><font color="#990000">).</font>value <font color="#990000">=</font> <font color="#FF0000">'Import successful!'</font>
      <font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>error<font color="#990000">)</font> <font color="#FF0000">{</font>
        console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>error<font color="#990000">)</font>
        document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_import_ta"</font><font color="#990000">).</font>value <font color="#990000">=</font> <font color="#FF0000">'Error importing file! Please try again. The file might not have proper JSON stringified keys'</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font><i><font color="#9A1900">// desired file content</font></i>
    reader<font color="#990000">.</font>onerror <font color="#990000">=</font> error <font color="#990000">=&gt;</font> <font color="#FF0000">{</font> console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>error<font color="#990000">);</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_import_ta"</font><font color="#990000">).</font>value <font color="#990000">=</font> <font color="#FF0000">'Error importing file! Please try again.'</font> <font color="#FF0000">}</font>
    <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'importKeyFile'</font><font color="#990000">).</font>files<font color="#990000">.</font>length <font color="#990000">&gt;</font> <font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font>
      reader<font color="#990000">.</font><b><font color="#000000">readAsText</font></b><font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'importKeyFile'</font><font color="#990000">).</font>files<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
    <font color="#FF0000">}</font>
    <b><font color="#0000FF">else</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
        <b><font color="#000000">importKeysToLS</font></b><font color="#990000">(</font>JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'key_import_ta'</font><font color="#990000">).</font>value<font color="#990000">));</font>
        document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_import_ta"</font><font color="#990000">).</font>value <font color="#990000">=</font> <font color="#FF0000">'Import successful!'</font>
      <font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>error<font color="#990000">)</font> <font color="#FF0000">{</font>
        console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>error<font color="#990000">)</font>
        document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_import_ta"</font><font color="#990000">).</font>value <font color="#990000">=</font> <font color="#FF0000">'Error importing keys! Please try again. Please ensure that the keys are in a JSON stringified format'</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> importKeysToLS <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">(</font>data<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
      let pem <font color="#990000">=</font> <b><font color="#0000FF">false</font></b><font color="#990000">;</font>
      <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>data<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">"pem"</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> data<font color="#990000">[</font><font color="#FF0000">"pem"</font><font color="#990000">]</font> <font color="#990000">===</font> <b><font color="#0000FF">true</font></b><font color="#990000">)</font> <font color="#FF0000">{</font>
        pem <font color="#990000">=</font> <b><font color="#0000FF">true</font></b><font color="#990000">;</font>
      <font color="#FF0000">}</font>
      <b><font color="#0000FF">for</font></b> <font color="#990000">(</font>let room <b><font color="#0000FF">in</font></b> data<font color="#990000">[</font><font color="#FF0000">'roomData'</font><font color="#990000">])</font> <font color="#FF0000">{</font>
        <b><font color="#0000FF">for</font></b> <font color="#990000">(</font>let type <b><font color="#0000FF">in</font></b> data<font color="#990000">[</font><font color="#FF0000">'roomData'</font><font color="#990000">][</font>room<font color="#990000">])</font> <font color="#FF0000">{</font>
          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>type <font color="#990000">===</font> <font color="#FF0000">'key'</font><font color="#990000">)</font> <font color="#FF0000">{</font>
            let key <font color="#990000">=</font> data<font color="#990000">[</font><font color="#FF0000">'roomData'</font><font color="#990000">][</font>room<font color="#990000">][</font>type<font color="#990000">]</font>
            <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>pem<font color="#990000">)</font> <font color="#FF0000">{</font>
              let cryptokey <font color="#990000">=</font> await <b><font color="#000000">importPrivatePemKey</font></b><font color="#990000">(</font>key<font color="#990000">);</font>
              let jsonKey <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">exportKey</font></b><font color="#990000">(</font><font color="#FF0000">"jwk"</font><font color="#990000">,</font> cryptokey<font color="#990000">);</font>
              key <font color="#990000">=</font> JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>jsonKey<font color="#990000">);</font>
            <font color="#FF0000">}</font>
            localStorage<font color="#990000">.</font><b><font color="#000000">setItem</font></b><font color="#990000">(</font>room<font color="#990000">,</font> key<font color="#990000">);</font>
          <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <font color="#FF0000">{</font>
            localStorage<font color="#990000">.</font><b><font color="#000000">setItem</font></b><font color="#990000">(</font>room <font color="#990000">+</font> <font color="#FF0000">'_'</font> <font color="#990000">+</font> type<font color="#990000">,</font> data<font color="#990000">[</font><font color="#FF0000">'roomData'</font><font color="#990000">][</font>room<font color="#990000">][</font>type<font color="#990000">]);</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
      localStorage<font color="#990000">.</font><b><font color="#000000">setItem</font></b><font color="#990000">(</font><font color="#FF0000">'rooms'</font><font color="#990000">,</font> JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>data<font color="#990000">[</font><font color="#FF0000">'roomMetadata'</font><font color="#990000">]));</font>
      localStorage<font color="#990000">.</font><b><font color="#000000">setItem</font></b><font color="#990000">(</font><font color="#FF0000">'contacts'</font><font color="#990000">,</font> JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>data<font color="#990000">[</font><font color="#FF0000">'contacts'</font><font color="#990000">]));</font>
      <b><font color="#000000">setData</font></b><font color="#990000">(</font>processLocalStorage<font color="#990000">)</font>
      props<font color="#990000">.</font><b><font color="#000000">refreshRooms</font></b><font color="#990000">();</font>
    <font color="#FF0000">}</font>
    <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>e<font color="#990000">)</font> <font color="#FF0000">{</font>
      console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>e<font color="#990000">);</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> processLocalStorage <font color="#990000">=</font> <font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <b><font color="#0000FF">const</font></b> _rooms <font color="#990000">=</font> <font color="#FF0000">{}</font><font color="#990000">;</font>
    Object<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">(</font>localStorage<font color="#990000">).</font><b><font color="#000000">forEach</font></b><font color="#990000">((</font>key<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>key <font color="#990000">!==</font> <font color="#FF0000">'rooms'</font> <font color="#990000">&amp;&amp;</font> key <font color="#990000">!==</font> <font color="#FF0000">'contacts'</font><font color="#990000">)</font> <font color="#FF0000">{</font>
        <b><font color="#0000FF">const</font></b> _roomName <font color="#990000">=</font> key<font color="#990000">.</font><b><font color="#000000">slice</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">64</font><font color="#990000">);</font>
        <b><font color="#0000FF">const</font></b> _type <font color="#990000">=</font> key<font color="#990000">.</font>length <font color="#990000">&gt;</font> <font color="#993399">64</font> <font color="#990000">?</font> key<font color="#990000">.</font><b><font color="#000000">slice</font></b><font color="#990000">(</font><font color="#993399">65</font><font color="#990000">)</font> <font color="#990000">:</font> <font color="#FF0000">'key'</font><font color="#990000">;</font>
        _rooms<font color="#990000">[</font>_roomName<font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#990000">...</font>_rooms<font color="#990000">[</font>_roomName<font color="#990000">]</font> <font color="#FF0000">}</font><font color="#990000">;</font>
        _rooms<font color="#990000">[</font>_roomName<font color="#990000">][</font>_type<font color="#990000">]</font> <font color="#990000">=</font> localStorage<font color="#990000">.</font><b><font color="#000000">getItem</font></b><font color="#990000">(</font>key<font color="#990000">);</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font><font color="#990000">);</font>
    <b><font color="#0000FF">const</font></b> _roomMetadata <font color="#990000">=</font> localStorage<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">'rooms'</font><font color="#990000">)</font> <font color="#990000">?</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>localStorage<font color="#990000">.</font><b><font color="#000000">getItem</font></b><font color="#990000">(</font><font color="#FF0000">'rooms'</font><font color="#990000">))</font> <font color="#990000">:</font> <font color="#FF0000">{}</font>
    <b><font color="#0000FF">const</font></b> _contacts <font color="#990000">=</font> localStorage<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">'contacts'</font><font color="#990000">)</font> <font color="#990000">?</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>localStorage<font color="#990000">.</font><b><font color="#000000">getItem</font></b><font color="#990000">(</font><font color="#FF0000">'contacts'</font><font color="#990000">))</font> <font color="#990000">:</font> <font color="#FF0000">{}</font><font color="#990000">;</font>
    <b><font color="#0000FF">return</font></b> <font color="#FF0000">{</font> roomData<font color="#990000">:</font> _rooms<font color="#990000">,</font> contacts<font color="#990000">:</font> _contacts<font color="#990000">,</font> roomMetadata<font color="#990000">:</font> _roomMetadata<font color="#990000">,</font> pem<font color="#990000">:</font> <b><font color="#0000FF">false</font></b> <font color="#FF0000">}</font><font color="#990000">;</font>
  <font color="#FF0000">}</font>

  <i><font color="#9A1900">/*</font></i>
<i><font color="#9A1900">  Export the given key and write it into the "exported-key" space.</font></i>
<i><font color="#9A1900">  */</font></i>
  <b><font color="#0000FF">const</font></b> exportPrivateCryptoKey <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">(</font>key<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <b><font color="#0000FF">const</font></b> exported <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">exportKey</font></b><font color="#990000">(</font>
      <font color="#FF0000">"pkcs8"</font><font color="#990000">,</font>
      key
    <font color="#990000">);</font>
    <b><font color="#0000FF">const</font></b> exportedAsString <font color="#990000">=</font> utils<font color="#990000">.</font><b><font color="#000000">ab2str</font></b><font color="#990000">(</font>exported<font color="#990000">);</font>
    <b><font color="#0000FF">const</font></b> exportedAsBase64 <font color="#990000">=</font> utils<font color="#990000">.</font><b><font color="#000000">partition</font></b><font color="#990000">(</font>window<font color="#990000">.</font><b><font color="#000000">btoa</font></b><font color="#990000">(</font>exportedAsString<font color="#990000">),</font> <font color="#993399">64</font><font color="#990000">).</font><b><font color="#000000">join</font></b><font color="#990000">(</font><font color="#FF0000">'</font><font color="#CC33CC">\n</font><font color="#FF0000">'</font><font color="#990000">);;</font>
    <b><font color="#0000FF">const</font></b> pemExported <font color="#990000">=</font> `<font color="#990000">-----</font>BEGIN PRIVATE KEY<font color="#990000">-----\</font>n$<font color="#FF0000">{</font>exportedAsBase64<font color="#FF0000">}</font><font color="#990000">\</font>n<font color="#990000">-----</font>END PRIVATE KEY<font color="#990000">-----</font>`<font color="#990000">;</font>

    <b><font color="#0000FF">return</font></b> pemExported
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> exportPemKeys <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <b><font color="#0000FF">const</font></b> _rooms <font color="#990000">=</font> <font color="#FF0000">{}</font><font color="#990000">;</font>
    <b><font color="#0000FF">for</font></b> <font color="#990000">(</font>let key of Object<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">(</font>localStorage<font color="#990000">))</font> <font color="#FF0000">{</font>
      <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>key <font color="#990000">!==</font> <font color="#FF0000">'rooms'</font> <font color="#990000">&amp;&amp;</font> key <font color="#990000">!==</font> <font color="#FF0000">'contacts'</font><font color="#990000">)</font> <font color="#FF0000">{</font>
        <b><font color="#0000FF">const</font></b> _roomName <font color="#990000">=</font> key<font color="#990000">.</font><b><font color="#000000">slice</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">,</font> <font color="#993399">64</font><font color="#990000">);</font>
        <b><font color="#0000FF">const</font></b> _type <font color="#990000">=</font> key<font color="#990000">.</font>length <font color="#990000">&gt;</font> <font color="#993399">64</font> <font color="#990000">?</font> key<font color="#990000">.</font><b><font color="#000000">slice</font></b><font color="#990000">(</font><font color="#993399">65</font><font color="#990000">)</font> <font color="#990000">:</font> <font color="#FF0000">'key'</font><font color="#990000">;</font>
        _rooms<font color="#990000">[</font>_roomName<font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">{</font> <font color="#990000">...</font>_rooms<font color="#990000">[</font>_roomName<font color="#990000">]</font> <font color="#FF0000">}</font><font color="#990000">;</font>
        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>_type <font color="#990000">===</font> <font color="#FF0000">'key'</font><font color="#990000">)</font> <font color="#FF0000">{</font>
          _rooms<font color="#990000">[</font>_roomName<font color="#990000">][</font>_type<font color="#990000">]</font> <font color="#990000">=</font> await <b><font color="#000000">exportPrivateCryptoKey</font></b><font color="#990000">(</font>await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">importKey</font></b><font color="#990000">(</font><font color="#FF0000">"jwk"</font><font color="#990000">,</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>localStorage<font color="#990000">.</font><b><font color="#000000">getItem</font></b><font color="#990000">(</font>key<font color="#990000">)),</font> <font color="#FF0000">{</font> name<font color="#990000">:</font> <font color="#FF0000">'ECDH'</font><font color="#990000">,</font> namedCurve<font color="#990000">:</font> <font color="#FF0000">'P-384'</font> <font color="#FF0000">}</font><font color="#990000">,</font> <b><font color="#0000FF">true</font></b><font color="#990000">,</font> <font color="#990000">[</font><font color="#FF0000">"deriveKey"</font><font color="#990000">]));</font>
        <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <font color="#FF0000">{</font>
          _rooms<font color="#990000">[</font>_roomName<font color="#990000">][</font>_type<font color="#990000">]</font> <font color="#990000">=</font> localStorage<font color="#990000">.</font><b><font color="#000000">getItem</font></b><font color="#990000">(</font>key<font color="#990000">);</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
    <b><font color="#0000FF">const</font></b> _roomMetadata <font color="#990000">=</font> localStorage<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">'rooms'</font><font color="#990000">)</font> <font color="#990000">?</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>localStorage<font color="#990000">.</font><b><font color="#000000">getItem</font></b><font color="#990000">(</font><font color="#FF0000">'rooms'</font><font color="#990000">))</font> <font color="#990000">:</font> <font color="#FF0000">{}</font>
    <b><font color="#0000FF">const</font></b> _contacts <font color="#990000">=</font> localStorage<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">'contacts'</font><font color="#990000">)</font> <font color="#990000">?</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>localStorage<font color="#990000">.</font><b><font color="#000000">getItem</font></b><font color="#990000">(</font><font color="#FF0000">'contacts'</font><font color="#990000">))</font> <font color="#990000">:</font> <font color="#FF0000">{}</font><font color="#990000">;</font>
    <b><font color="#000000">setData</font></b><font color="#990000">(</font><font color="#FF0000">{</font> roomData<font color="#990000">:</font> _rooms<font color="#990000">,</font> contacts<font color="#990000">:</font> _contacts<font color="#990000">,</font> roomMetadata<font color="#990000">:</font> _roomMetadata<font color="#990000">,</font> pem<font color="#990000">:</font> <b><font color="#0000FF">true</font></b> <font color="#FF0000">}</font><font color="#990000">);</font>
    <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_export_ta"</font><font color="#990000">)</font> <font color="#990000">!==</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> <font color="#FF0000">{</font>
      document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_export_ta"</font><font color="#990000">).</font>value <font color="#990000">=</font> JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font><font color="#FF0000">{</font> roomData<font color="#990000">:</font> _rooms<font color="#990000">,</font> contacts<font color="#990000">:</font> _contacts<font color="#990000">,</font> roomMetadata<font color="#990000">:</font> _roomMetadata<font color="#990000">,</font> pem<font color="#990000">:</font> <b><font color="#0000FF">true</font></b> <font color="#FF0000">}</font><font color="#990000">,</font> undefined<font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">)</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> importPrivatePemKey <font color="#990000">=</font> <font color="#990000">(</font>pem<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <i><font color="#9A1900">// fetch the part of the PEM string between header and footer</font></i>
    <b><font color="#0000FF">const</font></b> pemHeader <font color="#990000">=</font> <font color="#FF0000">"-----BEGIN PRIVATE KEY-----"</font><font color="#990000">;</font>
    <b><font color="#0000FF">const</font></b> pemFooter <font color="#990000">=</font> <font color="#FF0000">"-----END PRIVATE KEY-----"</font><font color="#990000">;</font>
    <b><font color="#0000FF">const</font></b> pemContents <font color="#990000">=</font> pem<font color="#990000">.</font><b><font color="#000000">substring</font></b><font color="#990000">(</font>pemHeader<font color="#990000">.</font>length<font color="#990000">,</font> pem<font color="#990000">.</font>length <font color="#990000">-</font> pemFooter<font color="#990000">.</font>length<font color="#990000">);</font>
    <i><font color="#9A1900">// base64 decode the string to get the binary data</font></i>
    <b><font color="#0000FF">const</font></b> binaryDerString <font color="#990000">=</font> window<font color="#990000">.</font><b><font color="#000000">atob</font></b><font color="#990000">(</font>pemContents<font color="#990000">);</font>
    <i><font color="#9A1900">// convert from a binary string to an ArrayBuffer</font></i>
    <b><font color="#0000FF">const</font></b> binaryDer <font color="#990000">=</font> utils<font color="#990000">.</font><b><font color="#000000">str2ab</font></b><font color="#990000">(</font>binaryDerString<font color="#990000">);</font>

    <b><font color="#0000FF">return</font></b> window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">importKey</font></b><font color="#990000">(</font>
      <font color="#FF0000">"pkcs8"</font><font color="#990000">,</font>
      binaryDer<font color="#990000">,</font>
      <font color="#FF0000">{</font>
        name<font color="#990000">:</font> <font color="#FF0000">"ECDH"</font><font color="#990000">,</font>
        namedCurve<font color="#990000">:</font> <font color="#FF0000">"P-384"</font><font color="#990000">,</font>
      <font color="#FF0000">}</font><font color="#990000">,</font>
      <b><font color="#0000FF">true</font></b><font color="#990000">,</font>
      <font color="#990000">[</font><font color="#FF0000">"deriveKey"</font><font color="#990000">]</font>
    <font color="#990000">);</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> downloadRoomData <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">(</font>roomId<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font><font color="#FF0000">"Fetching room data..."</font><font color="#990000">)</font>
    let fetchReq <font color="#990000">=</font> await <b><font color="#000000">fetch</font></b><font color="#990000">(</font>ROOM_SERVER <font color="#990000">+</font> roomId <font color="#990000">+</font> <font color="#FF0000">"/downloadData"</font><font color="#990000">);</font>
    let data <font color="#990000">=</font> await fetchReq<font color="#990000">.</font><b><font color="#000000">arrayBuffer</font></b><font color="#990000">();</font>
    console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font><font color="#FF0000">"Got data..."</font><font color="#990000">);</font>
    <b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
      let dataString <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">TextDecoder</font></b><font color="#990000">().</font><b><font color="#000000">decode</font></b><font color="#990000">(</font>data<font color="#990000">);</font>
      console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font><font color="#FF0000">"Got data string..."</font><font color="#990000">)</font>
      console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font><font color="#FF0000">"Will now process messages to find image ids"</font><font color="#990000">);</font>
      let dataJson <font color="#990000">=</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>dataString<font color="#990000">);</font>
      let room_lockedKey_string <font color="#990000">=</font> localStorage<font color="#990000">.</font><b><font color="#000000">getItem</font></b><font color="#990000">(</font>roomId <font color="#990000">+</font> <font color="#FF0000">"_lockedKey"</font><font color="#990000">);</font>
      let decKey_string <font color="#990000">=</font> dataJson<font color="#990000">[</font><font color="#FF0000">"encryptionKey"</font><font color="#990000">];</font>
      let decKey <font color="#990000">=</font> await crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">importKey</font></b><font color="#990000">(</font><font color="#FF0000">"jwk"</font><font color="#990000">,</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>decKey_string<font color="#990000">),</font> <font color="#FF0000">{</font> name<font color="#990000">:</font> <font color="#FF0000">"AES-GCM"</font> <font color="#FF0000">}</font><font color="#990000">,</font> <b><font color="#0000FF">false</font></b><font color="#990000">,</font> <font color="#990000">[</font><font color="#FF0000">"decrypt"</font><font color="#990000">]);</font>
      let room_lockedKey <font color="#990000">=</font> <b><font color="#0000FF">null</font></b><font color="#990000">;</font>
      <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>room_lockedKey_string <font color="#990000">!=</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> <font color="#FF0000">{</font>
        console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font><font color="#FF0000">"Found locked key in localstorage"</font><font color="#990000">)</font>
        room_lockedKey <font color="#990000">=</font> await crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">importKey</font></b><font color="#990000">(</font><font color="#FF0000">"jwk"</font><font color="#990000">,</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>room_lockedKey_string<font color="#990000">),</font> <font color="#FF0000">{</font> name<font color="#990000">:</font> <font color="#FF0000">"AES-GCM"</font> <font color="#FF0000">}</font><font color="#990000">,</font> <b><font color="#0000FF">false</font></b><font color="#990000">,</font> <font color="#990000">[</font><font color="#FF0000">"decrypt"</font><font color="#990000">]);</font>
      <font color="#FF0000">}</font>
      console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font><font color="#FF0000">"Imported decryption keys"</font><font color="#990000">,</font> decKey<font color="#990000">,</font> room_lockedKey<font color="#990000">)</font>
      let imageData <font color="#990000">=</font> await <b><font color="#000000">getImageIds</font></b><font color="#990000">(</font>dataJson<font color="#990000">,</font> decKey<font color="#990000">,</font> room_lockedKey<font color="#990000">);</font>
      imageData<font color="#990000">[</font><font color="#FF0000">"target"</font><font color="#990000">]</font> <font color="#990000">=</font> <font color="#FF0000">"s4.privacy.app"</font><font color="#990000">;</font>
      let imagedataString <font color="#990000">=</font> JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>imageData<font color="#990000">);</font>
      <b><font color="#000000">downloadFile</font></b><font color="#990000">(</font>imagedataString<font color="#990000">,</font> rooms<font color="#990000">[</font>roomId<font color="#990000">][</font><font color="#FF0000">"name"</font><font color="#990000">]</font> <font color="#990000">+</font> <font color="#FF0000">"_storage.txt"</font><font color="#990000">)</font>
      <b><font color="#000000">downloadFile</font></b><font color="#990000">(</font>dataString<font color="#990000">,</font> rooms<font color="#990000">[</font>roomId<font color="#990000">][</font><font color="#FF0000">"name"</font><font color="#990000">]</font> <font color="#990000">+</font> <font color="#FF0000">"_data.txt"</font><font color="#990000">);</font>
    <font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>err<font color="#990000">)</font> <font color="#FF0000">{</font>
      console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>err<font color="#990000">);</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> getImageIds <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">(</font>messages<font color="#990000">,</font> decKey<font color="#990000">,</font> lockedKey<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    let unwrapped_messages <font color="#990000">=</font> <font color="#FF0000">{}</font>
    <b><font color="#0000FF">for</font></b> <font color="#990000">(</font>let id <b><font color="#0000FF">in</font></b> messages<font color="#990000">)</font> <font color="#FF0000">{</font>
      <b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
        let message <font color="#990000">=</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>messages<font color="#990000">[</font>id<font color="#990000">]);</font>
        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>message<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">"encrypted_contents"</font><font color="#990000">))</font> <font color="#FF0000">{</font>
	  let _contents <font color="#990000">=</font> message<font color="#990000">.</font>encrypted_contents<font color="#990000">;</font>
	  <i><font color="#9A1900">// let _contents = JSON.parse(message.encrypted_contents);</font></i>
          let msg <font color="#990000">=</font> await <b><font color="#000000">decrypt</font></b><font color="#990000">(</font>decKey<font color="#990000">,</font> _contents<font color="#990000">)</font>
          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>msg<font color="#990000">.</font>error <font color="#990000">&amp;&amp;</font> lockedKey <font color="#990000">!==</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> <font color="#FF0000">{</font>
            msg <font color="#990000">=</font> await <b><font color="#000000">decrypt</font></b><font color="#990000">(</font>lockedKey<font color="#990000">,</font> _contents<font color="#990000">)</font>
          <font color="#FF0000">}</font>
          <i><font color="#9A1900">// console.log(msg)</font></i>
          <b><font color="#0000FF">const</font></b> _json_msg <font color="#990000">=</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>msg<font color="#990000">.</font>plaintext<font color="#990000">);</font>
          <i><font color="#9A1900">// console.log(_json_msg)</font></i>
          <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>_json_msg<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">'control'</font><font color="#990000">))</font> <font color="#FF0000">{</font>
            console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>_json_msg<font color="#990000">)</font>
            unwrapped_messages<font color="#990000">[</font>_json_msg<font color="#990000">[</font><font color="#FF0000">"id"</font><font color="#990000">]</font> <font color="#990000">+</font> <font color="#FF0000">"."</font>  <font color="#990000">+</font> <font color="#990000">(</font>_json_msg<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">"type"</font><font color="#990000">)</font> <font color="#990000">?</font> _json_msg<font color="#990000">[</font><font color="#FF0000">"type"</font><font color="#990000">]</font> <font color="#990000">:</font> <font color="#FF0000">""</font><font color="#990000">)]</font> <font color="#990000">=</font> _json_msg<font color="#990000">[</font><font color="#FF0000">'verificationToken'</font><font color="#990000">];</font>
          <font color="#FF0000">}</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>e<font color="#990000">)</font> <font color="#FF0000">{</font>
        <i><font color="#9A1900">// console.log(e);</font></i>
        <i><font color="#9A1900">// Skip the message if decryption fails - its probably due to the user not having &lt;roomId&gt;_lockedKey. </font></i>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font>
    <b><font color="#0000FF">return</font></b> unwrapped_messages<font color="#990000">;</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> uploadRoomData <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <b><font color="#0000FF">const</font></b> reader <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">FileReader</font></b><font color="#990000">()</font>
    let roomId <font color="#990000">=</font> <b><font color="#0000FF">null</font></b><font color="#990000">;</font>
    reader<font color="#990000">.</font>onload <font color="#990000">=</font> async event <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
      <b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">const</font></b> dataJSON <font color="#990000">=</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>event<font color="#990000">.</font>target<font color="#990000">.</font>result<font color="#990000">);</font>
        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"serverSecretInput"</font><font color="#990000">)</font> <font color="#990000">!==</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> <font color="#FF0000">{</font>
          dataJSON<font color="#990000">[</font><font color="#FF0000">"SERVER_SECRET"</font><font color="#990000">]</font> <font color="#990000">=</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"serverSecretInput"</font><font color="#990000">).</font>value<font color="#990000">;</font>
        <font color="#FF0000">}</font>
        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>dataJSON<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">"roomId"</font><font color="#990000">))</font> <font color="#FF0000">{</font>
          roomId <font color="#990000">=</font> dataJSON<font color="#990000">[</font><font color="#FF0000">"roomId"</font><font color="#990000">];</font>
	  console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>roomId<font color="#990000">);</font>
          let data <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">TextEncoder</font></b><font color="#990000">().</font><b><font color="#000000">encode</font></b><font color="#990000">(</font>JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>dataJSON<font color="#990000">));</font>
          let req <font color="#990000">=</font> await <b><font color="#000000">fetch</font></b><font color="#990000">(</font>ROOM_SERVER <font color="#990000">+</font> roomId <font color="#990000">+</font> <font color="#FF0000">"/uploadRoom"</font><font color="#990000">,</font> <font color="#FF0000">{</font>
            method<font color="#990000">:</font> <font color="#FF0000">"POST"</font><font color="#990000">,</font>
            body<font color="#990000">:</font> data
          <font color="#FF0000">}</font><font color="#990000">);</font>
	  req<font color="#990000">.</font><b><font color="#000000">json</font></b><font color="#990000">().</font><b><font color="#000000">then</font></b><font color="#990000">((</font>j<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font> <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>j<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">'error'</font><font color="#990000">))</font> JwModal<font color="#990000">.</font><b><font color="#000000">open</font></b><font color="#990000">(</font><font color="#FF0000">'landing-response'</font><font color="#990000">,</font> <font color="#FF0000">'Error from room server: '</font> <font color="#990000">+</font> j<font color="#990000">[</font><font color="#FF0000">'error'</font><font color="#990000">]);</font>
				   <b><font color="#0000FF">else</font></b> JwModal<font color="#990000">.</font><b><font color="#000000">open</font></b><font color="#990000">(</font><font color="#FF0000">'landing-response'</font><font color="#990000">,</font> <font color="#FF0000">'Room has been imported! Room &lt;id&gt; is '</font> <font color="#990000">+</font> roomId<font color="#990000">);</font> <font color="#FF0000">}</font> <font color="#990000">);</font>
        <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b> <font color="#FF0000">{</font>
	  JwModal<font color="#990000">.</font><b><font color="#000000">open</font></b><font color="#990000">(</font><font color="#FF0000">'landing-response'</font><font color="#990000">,</font> <font color="#FF0000">'That room id is not present in the file'</font><font color="#990000">);</font>
        <font color="#FF0000">}</font>
      <font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>error<font color="#990000">)</font> <font color="#FF0000">{</font>
	JwModal<font color="#990000">.</font><b><font color="#000000">open</font></b><font color="#990000">(</font><font color="#FF0000">'landing-response'</font><font color="#990000">,</font> <font color="#FF0000">'Error loading room ('</font> <font color="#990000">+</font> error<font color="#990000">.</font>message <font color="#990000">+</font> <font color="#FF0000">')'</font><font color="#990000">);</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font><i><font color="#9A1900">// desired file content</font></i>
    reader<font color="#990000">.</font>onerror <font color="#990000">=</font> error <font color="#990000">=&gt;</font> <font color="#FF0000">{</font> console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>error<font color="#990000">)</font> <font color="#FF0000">}</font>
    <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'uploadRoomFile'</font><font color="#990000">).</font>files<font color="#990000">.</font>length <font color="#990000">&gt;</font> <font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font>
      reader<font color="#990000">.</font><b><font color="#000000">readAsText</font></b><font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'uploadRoomFile'</font><font color="#990000">).</font>files<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> uploadStorageData <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font><font color="#FF0000">"In function"</font><font color="#990000">)</font>
    <b><font color="#0000FF">const</font></b> reader <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">FileReader</font></b><font color="#990000">()</font>
    reader<font color="#990000">.</font>onload <font color="#990000">=</font> async event <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
      <b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
        <b><font color="#0000FF">const</font></b> dataJSON <font color="#990000">=</font> JSON<font color="#990000">.</font><b><font color="#000000">parse</font></b><font color="#990000">(</font>event<font color="#990000">.</font>target<font color="#990000">.</font>result<font color="#990000">);</font>
        <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"storageServerSecretInput"</font><font color="#990000">)</font> <font color="#990000">!==</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> <font color="#FF0000">{</font>
          dataJSON<font color="#990000">[</font><font color="#FF0000">"SERVER_SECRET"</font><font color="#990000">]</font> <font color="#990000">=</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"storageServerSecretInput"</font><font color="#990000">).</font>value<font color="#990000">;</font>
        <font color="#FF0000">}</font>
        let data <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">TextEncoder</font></b><font color="#990000">().</font><b><font color="#000000">encode</font></b><font color="#990000">(</font>JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>dataJSON<font color="#990000">));</font>
        let req <font color="#990000">=</font> await <b><font color="#000000">fetch</font></b><font color="#990000">(</font>STORAGE_SERVER <font color="#990000">+</font> <font color="#FF0000">"migrateStorage"</font><font color="#990000">,</font> <font color="#FF0000">{</font>
          method<font color="#990000">:</font> <font color="#FF0000">"POST"</font><font color="#990000">,</font>
          body<font color="#990000">:</font> data
        <font color="#FF0000">}</font><font color="#990000">);</font>
      <font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>error<font color="#990000">)</font> <font color="#FF0000">{</font>
        console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>error<font color="#990000">)</font>
      <font color="#FF0000">}</font>
    <font color="#FF0000">}</font><i><font color="#9A1900">// desired file content</font></i>
    reader<font color="#990000">.</font>onerror <font color="#990000">=</font> error <font color="#990000">=&gt;</font> <font color="#FF0000">{</font> console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>error<font color="#990000">)</font> <font color="#FF0000">}</font>
    <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'uploadStorageFile'</font><font color="#990000">).</font>files<font color="#990000">.</font>length <font color="#990000">&gt;</font> <font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font>
      reader<font color="#990000">.</font><b><font color="#000000">readAsText</font></b><font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'uploadStorageFile'</font><font color="#990000">).</font>files<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> createNewRoom <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    let ownerKeyPair <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">generateKey</font></b><font color="#990000">(</font><font color="#FF0000">{</font> name<font color="#990000">:</font> <font color="#FF0000">"ECDH"</font><font color="#990000">,</font> namedCurve<font color="#990000">:</font> <font color="#FF0000">"P-384"</font> <font color="#FF0000">}</font><font color="#990000">,</font> <b><font color="#0000FF">true</font></b><font color="#990000">,</font> <font color="#990000">[</font><font color="#FF0000">"deriveKey"</font><font color="#990000">]);</font>
    let exportable_privateKey <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">exportKey</font></b><font color="#990000">(</font><font color="#FF0000">"jwk"</font><font color="#990000">,</font> ownerKeyPair<font color="#990000">.</font>privateKey<font color="#990000">);</font>
    let exportable_pubKey <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">exportKey</font></b><font color="#990000">(</font><font color="#FF0000">"jwk"</font><font color="#990000">,</font> ownerKeyPair<font color="#990000">.</font>publicKey<font color="#990000">);</font>
    let roomId <font color="#990000">=</font> await <b><font color="#000000">generateRoomId</font></b><font color="#990000">(</font>exportable_pubKey<font color="#990000">.</font>x<font color="#990000">,</font> exportable_pubKey<font color="#990000">.</font>y<font color="#990000">);</font>
    let encryptionKey <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">generateKey</font></b><font color="#990000">(</font><font color="#FF0000">{</font> name<font color="#990000">:</font> <font color="#FF0000">"AES-GCM"</font><font color="#990000">,</font> length<font color="#990000">:</font> <font color="#993399">256</font> <font color="#FF0000">}</font><font color="#990000">,</font> <b><font color="#0000FF">true</font></b><font color="#990000">,</font> <font color="#990000">[</font><font color="#FF0000">"encrypt"</font><font color="#990000">,</font> <font color="#FF0000">"decrypt"</font><font color="#990000">]);</font>
    let exportable_encryptionKey <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">exportKey</font></b><font color="#990000">(</font><font color="#FF0000">"jwk"</font><font color="#990000">,</font> encryptionKey<font color="#990000">);</font>
    let signKeyPair <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">generateKey</font></b><font color="#990000">(</font><font color="#FF0000">{</font> name<font color="#990000">:</font> <font color="#FF0000">"ECDH"</font><font color="#990000">,</font> namedCurve<font color="#990000">:</font> <font color="#FF0000">"P-384"</font> <font color="#FF0000">}</font><font color="#990000">,</font> <b><font color="#0000FF">true</font></b><font color="#990000">,</font> <font color="#990000">[</font><font color="#FF0000">"deriveKey"</font><font color="#990000">]);</font>
    let exportable_signKey <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">exportKey</font></b><font color="#990000">(</font><font color="#FF0000">"jwk"</font><font color="#990000">,</font> signKeyPair<font color="#990000">.</font>privateKey<font color="#990000">);</font>
    <i><font color="#9A1900">// let ledgerKey = await window.crypto.subtle.generateKey({ name: "RSA-OAEP", modulusLength: 4096, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }, true, ["encrypt", "decrypt"] );</font></i>
    <i><font color="#9A1900">// let exportable_ledgerKey = await window.crypto.subtle.exportKey("jwk", ledgerKey.publicKey);</font></i>
    let roomData <font color="#990000">=</font> <font color="#FF0000">{</font> roomId<font color="#990000">:</font> roomId<font color="#990000">,</font> ownerKey<font color="#990000">:</font> JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>exportable_pubKey<font color="#990000">),</font> encryptionKey<font color="#990000">:</font> JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>exportable_encryptionKey<font color="#990000">),</font> signKey<font color="#990000">:</font> JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>exportable_signKey<font color="#990000">)</font> <font color="#FF0000">}</font>
    <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"serverSecretInput"</font><font color="#990000">)</font> <font color="#990000">!==</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> <font color="#FF0000">{</font>
      roomData<font color="#990000">[</font><font color="#FF0000">"SERVER_SECRET"</font><font color="#990000">]</font> <font color="#990000">=</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"serverSecretInput"</font><font color="#990000">).</font>value<font color="#990000">;</font>
    <font color="#FF0000">}</font>
    let data <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">TextEncoder</font></b><font color="#990000">().</font><b><font color="#000000">encode</font></b><font color="#990000">(</font>JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>roomData<font color="#990000">));</font>
    let req <font color="#990000">=</font> await <b><font color="#000000">fetch</font></b><font color="#990000">(</font>ROOM_SERVER <font color="#990000">+</font> roomId <font color="#990000">+</font> <font color="#FF0000">"/uploadRoom"</font><font color="#990000">,</font> <font color="#FF0000">{</font>
      method<font color="#990000">:</font> <font color="#FF0000">"POST"</font><font color="#990000">,</font>
      body<font color="#990000">:</font> data
    <font color="#FF0000">}</font><font color="#990000">);</font>
    let resp <font color="#990000">=</font> await req<font color="#990000">.</font><b><font color="#000000">json</font></b><font color="#990000">();</font>
    <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>resp<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font><font color="#FF0000">"success"</font><font color="#990000">)</font> <font color="#990000">&amp;&amp;</font> resp<font color="#990000">[</font><font color="#FF0000">"success"</font><font color="#990000">]</font> <font color="#990000">===</font> <b><font color="#0000FF">true</font></b><font color="#990000">)</font> <font color="#FF0000">{</font>
      localStorage<font color="#990000">.</font><b><font color="#000000">setItem</font></b><font color="#990000">(</font>roomId<font color="#990000">,</font> JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>exportable_privateKey<font color="#990000">));</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> generateRoomId <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">(</font>x<font color="#990000">,</font> y<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    let xBytes <font color="#990000">=</font> utils<font color="#990000">.</font><b><font color="#000000">base64ToArrayBuffer</font></b><font color="#990000">(</font>utils<font color="#990000">.</font><b><font color="#000000">decodeB64Url</font></b><font color="#990000">(</font>x<font color="#990000">));</font>
    let yBytes <font color="#990000">=</font> utils<font color="#990000">.</font><b><font color="#000000">base64ToArrayBuffer</font></b><font color="#990000">(</font>utils<font color="#990000">.</font><b><font color="#000000">decodeB64Url</font></b><font color="#990000">(</font>y<font color="#990000">));</font>
    let roomBytes <font color="#990000">=</font> utils<font color="#990000">.</font><b><font color="#000000">_appendBuffer</font></b><font color="#990000">(</font>xBytes<font color="#990000">,</font> yBytes<font color="#990000">);</font>
    let roomBytesHash <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">digest</font></b><font color="#990000">(</font><font color="#FF0000">"SHA-384"</font><font color="#990000">,</font> roomBytes<font color="#990000">);</font>
    <b><font color="#0000FF">return</font></b> utils<font color="#990000">.</font><b><font color="#000000">encodeB64Url</font></b><font color="#990000">(</font>utils<font color="#990000">.</font><b><font color="#000000">arrayBufferToBase64</font></b><font color="#990000">(</font>roomBytesHash<font color="#990000">));</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> authorizeRoom <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'authorizeRoomServerSecretInput'</font><font color="#990000">)</font> <font color="#990000">!==</font> <b><font color="#0000FF">null</font></b> <font color="#990000">&amp;&amp;</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'authorizeRoomIdInput'</font><font color="#990000">)</font> <font color="#990000">!==</font> <b><font color="#0000FF">null</font></b> <font color="#990000">&amp;&amp;</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'authorizeOwnerInput'</font><font color="#990000">))</font> <font color="#FF0000">{</font>
      let roomId <font color="#990000">=</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'authorizeRoomIdInput'</font><font color="#990000">).</font>value<font color="#990000">;</font>
      let secret <font color="#990000">=</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'authorizeRoomServerSecretInput'</font><font color="#990000">).</font>value<font color="#990000">;</font>
      let ownerKey <font color="#990000">=</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'authorizeOwnerInput'</font><font color="#990000">).</font>value<font color="#990000">;</font>
      let req <font color="#990000">=</font> await <b><font color="#000000">fetch</font></b><font color="#990000">(</font>ROOM_SERVER <font color="#990000">+</font> roomId <font color="#990000">+</font> <font color="#FF0000">"/authorizeRoom"</font><font color="#990000">,</font> <font color="#FF0000">{</font>
        method<font color="#990000">:</font> <font color="#FF0000">"POST"</font><font color="#990000">,</font>
        body<font color="#990000">:</font> <font color="#FF0000">{</font> roomId<font color="#990000">:</font> roomId<font color="#990000">,</font> SERVER_SECRET<font color="#990000">:</font> secret<font color="#990000">,</font> ownerKey<font color="#990000">:</font> ownerKey <font color="#FF0000">}</font>
      <font color="#FF0000">}</font><font color="#990000">);</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  <b><font color="#0000FF">const</font></b> decrypt <font color="#990000">=</font> <b><font color="#000000">async</font></b> <font color="#990000">(</font>secretKey<font color="#990000">,</font> contents<font color="#990000">,</font> outputType <font color="#990000">=</font> <font color="#FF0000">"string"</font><font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    <b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
      <b><font color="#0000FF">const</font></b> ciphertext <font color="#990000">=</font> <b><font color="#0000FF">typeof</font></b> contents<font color="#990000">.</font>content <font color="#990000">===</font> <font color="#FF0000">'string'</font> <font color="#990000">?</font> utils<font color="#990000">.</font><b><font color="#000000">base64ToArrayBuffer</font></b><font color="#990000">(</font><b><font color="#000000">decodeURIComponent</font></b><font color="#990000">(</font>contents<font color="#990000">.</font>content<font color="#990000">))</font> <font color="#990000">:</font> contents<font color="#990000">.</font>content<font color="#990000">;</font>
      <b><font color="#0000FF">const</font></b> iv <font color="#990000">=</font> <b><font color="#0000FF">typeof</font></b> contents<font color="#990000">.</font>iv <font color="#990000">===</font> <font color="#FF0000">'string'</font> <font color="#990000">?</font> utils<font color="#990000">.</font><b><font color="#000000">base64ToArrayBuffer</font></b><font color="#990000">(</font><b><font color="#000000">decodeURIComponent</font></b><font color="#990000">(</font>contents<font color="#990000">.</font>iv<font color="#990000">))</font> <font color="#990000">:</font> contents<font color="#990000">.</font>iv<font color="#990000">;</font>
      let decrypted <font color="#990000">=</font> await window<font color="#990000">.</font>crypto<font color="#990000">.</font>subtle<font color="#990000">.</font><b><font color="#000000">decrypt</font></b><font color="#990000">(</font>
        <font color="#FF0000">{</font>
          name<font color="#990000">:</font> <font color="#FF0000">"AES-GCM"</font><font color="#990000">,</font>
          iv<font color="#990000">:</font> iv
        <font color="#FF0000">}</font><font color="#990000">,</font>
        secretKey<font color="#990000">,</font>
        ciphertext
      <font color="#990000">);</font>
      <b><font color="#0000FF">if</font></b> <font color="#990000">(</font>outputType <font color="#990000">===</font> <font color="#FF0000">"string"</font><font color="#990000">)</font> <font color="#FF0000">{</font>
        <b><font color="#0000FF">return</font></b> <font color="#FF0000">{</font> error<font color="#990000">:</font> <b><font color="#0000FF">false</font></b><font color="#990000">,</font> plaintext<font color="#990000">:</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">TextDecoder</font></b><font color="#990000">().</font><b><font color="#000000">decode</font></b><font color="#990000">(</font>decrypted<font color="#990000">)</font> <font color="#FF0000">}</font><font color="#990000">;</font>
      <font color="#FF0000">}</font>
      <b><font color="#0000FF">return</font></b> <font color="#FF0000">{</font> error<font color="#990000">:</font> <b><font color="#0000FF">false</font></b><font color="#990000">,</font> plaintext<font color="#990000">:</font> decrypted <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>e<font color="#990000">)</font> <font color="#FF0000">{</font>
      <i><font color="#9A1900">// console.log(e);</font></i>
      <b><font color="#0000FF">return</font></b> <font color="#FF0000">{</font> error<font color="#990000">:</font> <b><font color="#0000FF">true</font></b><font color="#990000">,</font> plaintext<font color="#990000">:</font> <font color="#FF0000">"(whispered)"</font> <font color="#FF0000">}</font><font color="#990000">;</font>
    <font color="#FF0000">}</font>
  <font color="#FF0000">}</font>

  let <font color="#990000">[</font>data<font color="#990000">,</font> setData<font color="#990000">]</font> <font color="#990000">=</font> <b><font color="#000000">useState</font></b><font color="#990000">(</font><b><font color="#000000">processLocalStorage</font></b><font color="#990000">());</font>

  <b><font color="#0000FF">const</font></b> rooms_found <font color="#990000">=</font> props<font color="#990000">.</font>rooms <font color="#990000">!==</font> <b><font color="#0000FF">null</font></b> <font color="#990000">&amp;&amp;</font> Object<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">(</font>props<font color="#990000">.</font>rooms<font color="#990000">).</font>length <font color="#990000">&gt;</font> <font color="#993399">0</font><font color="#990000">;</font>
  <b><font color="#000000">setTimeout</font></b><font color="#990000">(()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
    document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font>window<font color="#990000">.</font>location<font color="#990000">.</font>hash<font color="#990000">.</font><b><font color="#000000">split</font></b><font color="#990000">(</font><font color="#FF0000">'#'</font><font color="#990000">)[</font><font color="#993399">1</font><font color="#990000">])</font> <font color="#990000">&amp;&amp;</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font>window<font color="#990000">.</font>location<font color="#990000">.</font>hash<font color="#990000">.</font><b><font color="#000000">split</font></b><font color="#990000">(</font><font color="#FF0000">'#'</font><font color="#990000">)[</font><font color="#993399">1</font><font color="#990000">]).</font><b><font color="#000000">scrollIntoView</font></b><font color="#990000">()</font>
  <font color="#FF0000">}</font><font color="#990000">,</font> <font color="#993399">0</font><font color="#990000">);</font>
  <b><font color="#0000FF">return</font></b> <font color="#990000">(</font>
    <font color="#990000">&lt;</font>div className<font color="#990000">=</font><font color="#FF0000">{</font><font color="#FF0000">"landingPage "</font> <font color="#990000">+</font> props<font color="#990000">.</font>className<font color="#FF0000">}</font><font color="#990000">&gt;</font>
      <font color="#990000">&lt;</font>JwModal id<font color="#990000">=</font><font color="#FF0000">"landing-response"</font><font color="#990000">&gt;</font>
        <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button gray-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font>JwModal<font color="#990000">.</font><b><font color="#000000">close</font></b><font color="#990000">(</font><font color="#FF0000">'landing-response'</font><font color="#990000">)</font><font color="#FF0000">}</font><font color="#990000">&gt;</font>Close<font color="#990000">&lt;/</font>button<font color="#990000">&gt;</font>
      <font color="#990000">&lt;/</font>JwModal<font color="#990000">&gt;</font>
      <font color="#990000">&lt;</font>JwModal id<font color="#990000">=</font><font color="#FF0000">"rename-room"</font><font color="#990000">&gt;</font>
        <font color="#990000">&lt;</font>label htmlFor<font color="#990000">=</font><font color="#FF0000">"roomname-input"</font><font color="#990000">&gt;&lt;</font>h2<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'room rename header modal'</font><font color="#990000">&gt;</font>Rename Room<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>h2<font color="#990000">&gt;&lt;/</font>label<font color="#990000">&gt;</font>
        <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
        <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">"text"</font> id<font color="#990000">=</font><font color="#FF0000">'roomname-input'</font> placeholder<font color="#990000">=</font><font color="#FF0000">"Enter Roomname Here"</font> defaultValue<font color="#990000">=</font><font color="#FF0000">{</font>rooms<font color="#990000">.</font><b><font color="#000000">hasOwnProperty</font></b><font color="#990000">(</font>renameRoom<font color="#990000">)</font> <font color="#990000">?</font> rooms<font color="#990000">[</font>renameRoom<font color="#990000">][</font><font color="#FF0000">'name'</font><font color="#990000">]</font> <font color="#990000">:</font> <font color="#FF0000">''</font><font color="#FF0000">}</font> onFocus<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">(</font>event<font color="#990000">)</font> <font color="#990000">=&gt;</font> event<font color="#990000">.</font>target<font color="#990000">.</font><b><font color="#000000">select</font></b><font color="#990000">()</font><font color="#FF0000">}</font> autoFocus <font color="#990000">/&gt;</font>
        <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
        <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button green-btn'</font> id<font color="#990000">=</font><font color="#FF0000">'change-roomname-save-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">(</font>event<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
          rooms<font color="#990000">[</font>renameRoom<font color="#990000">][</font><font color="#FF0000">'name'</font><font color="#990000">]</font> <font color="#990000">=</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'roomname-input'</font><font color="#990000">).</font>value<font color="#990000">;</font>
          <b><font color="#000000">setRooms</font></b><font color="#990000">(</font><font color="#FF0000">{</font> <font color="#990000">...</font>rooms <font color="#FF0000">}</font><font color="#990000">);</font>
          props<font color="#990000">.</font><b><font color="#000000">updateRoomNames</font></b><font color="#990000">(</font>rooms<font color="#990000">);</font>
          JwModal<font color="#990000">.</font><b><font color="#000000">close</font></b><font color="#990000">(</font><font color="#FF0000">'rename-room'</font><font color="#990000">)(</font>event<font color="#990000">);</font>
        <font color="#FF0000">}}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'save button text'</font><font color="#990000">&gt;</font>Save<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>button<font color="#990000">&gt;</font>
        <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button gray-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font>JwModal<font color="#990000">.</font><b><font color="#000000">close</font></b><font color="#990000">(</font><font color="#FF0000">'rename-room'</font><font color="#990000">)</font><font color="#FF0000">}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'Cancel Button Text'</font><font color="#990000">&gt;</font>Cancel<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>button<font color="#990000">&gt;</font>
      <font color="#990000">&lt;/</font>JwModal<font color="#990000">&gt;</font>
      <font color="#990000">&lt;</font>h2<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'welcome header'</font><font color="#990000">&gt;</font>Welcome to Snackabra<font color="#990000">!&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>h2<font color="#990000">&gt;</font>
      <font color="#990000">&lt;</font>p<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'member message'</font><font color="#990000">&gt;</font>If you are a <font color="#990000">&lt;</font>a href<font color="#990000">=</font><font color="#FF0000">'https://privacy.app//member'</font><font color="#990000">&gt;</font>Privacy<font color="#990000">.</font>App Member<font color="#990000">&lt;</font><font color="#FF6600">/a&gt;, you can log in on your membership page, which will manage your rooms for you.&lt;/</font>Trans<font color="#990000">&gt;&lt;/</font>p<font color="#990000">&gt;</font>
      <font color="#FF0000">{</font>rooms_found <font color="#990000">?</font>
        <font color="#990000">&lt;</font>div id<font color="#990000">=</font><font color="#FF0000">"roomList"</font><font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>h3<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'room list header'</font><font color="#990000">&gt;</font>Rooms <font color="#990000">&amp;</font>emsp<font color="#990000">;&lt;</font><font color="#FF6600">/Trans&gt;&lt;img src={refresh_icon} style={{ cursor: 'pointer', verticalAlign: 'middle' }} alt='Refresh room list' onClick={() =&gt; props.refreshRooms()}&gt;&lt;/img</font><font color="#990000">&gt;&lt;/</font>h3<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>table id<font color="#990000">=</font><font color="#FF0000">"roomListTable"</font><font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>tbody style<font color="#990000">=</font><font color="#FF0000">{{</font> width<font color="#990000">:</font> <font color="#FF0000">"100%"</font> <font color="#FF0000">}}</font><font color="#990000">&gt;</font>
              <font color="#FF0000">{</font>props<font color="#990000">.</font><b><font color="#000000">sortRooms</font></b><font color="#990000">(</font>rooms<font color="#990000">).</font><b><font color="#000000">map</font></b><font color="#990000">((</font>room<font color="#990000">)</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
                <b><font color="#0000FF">return</font></b> <font color="#990000">(</font>
                  <font color="#990000">&lt;</font>tr key<font color="#990000">=</font><font color="#FF0000">{</font>room<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]</font><font color="#FF0000">}</font><font color="#990000">&gt;</font>
                    <font color="#990000">&lt;</font>td id<font color="#990000">=</font><font color="#FF0000">"roomname_edit_td"</font><font color="#990000">&gt;&lt;</font>img src<font color="#990000">=</font><font color="#FF0000">{</font>edit_icon<font color="#FF0000">}</font> style<font color="#990000">=</font><font color="#FF0000">{{</font> cursor<font color="#990000">:</font> <font color="#FF0000">'pointer'</font> <font color="#FF0000">}}</font> alt<font color="#990000">=</font><font color="#FF0000">'Rename Room'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
                      <b><font color="#000000">setRenameRoom</font></b><font color="#990000">(</font>room<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
                      JwModal<font color="#990000">.</font><b><font color="#000000">open</font></b><font color="#990000">(</font><font color="#FF0000">'rename-room'</font><font color="#990000">);</font>
                    <font color="#FF0000">}}</font> <font color="#FF6600">/&gt;&lt;/</font>td<font color="#990000">&gt;</font>
                    <font color="#990000">&lt;</font>td id<font color="#990000">=</font><font color="#FF0000">"download_roomData_td"</font><font color="#990000">&gt;&lt;</font>img src<font color="#990000">=</font><font color="#FF0000">{</font>download_icon<font color="#FF0000">}</font> style<font color="#990000">=</font><font color="#FF0000">{{</font> cursor<font color="#990000">:</font> <font color="#FF0000">'pointer'</font><font color="#990000">,</font> width<font color="#990000">:</font> <font color="#FF0000">'24px'</font> <font color="#FF0000">}}</font> alt<font color="#990000">=</font><font color="#FF0000">'Download room data'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
                      <b><font color="#000000">downloadRoomData</font></b><font color="#990000">(</font>room<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
                    <font color="#FF0000">}}</font> <font color="#FF6600">/&gt;&lt;/</font>td<font color="#990000">&gt;</font>
                    <font color="#990000">&lt;</font>td id<font color="#990000">=</font><font color="#FF0000">'roomname_td'</font><font color="#990000">&gt;&lt;</font>div id<font color="#990000">=</font><font color="#FF0000">'roomname_td_div'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
                      props<font color="#990000">.</font><b><font color="#000000">goToRoom</font></b><font color="#990000">(</font>room<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
                      history<font color="#990000">.</font><b><font color="#000000">push</font></b><font color="#990000">(</font>room<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
                    <font color="#FF0000">}}</font><font color="#990000">&gt;</font><font color="#FF0000">{</font>room<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">][</font><font color="#FF0000">'unread'</font><font color="#990000">]</font> <font color="#990000">?</font> <font color="#990000">&lt;</font>b<font color="#990000">&gt;</font><font color="#FF0000">{</font>room<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">][</font><font color="#FF0000">'name'</font><font color="#990000">]</font><font color="#FF0000">}</font><font color="#990000">&lt;</font><font color="#FF6600">/b&gt; : room[1]['name']}&lt;/</font>div<font color="#990000">&gt;&lt;/</font>td<font color="#990000">&gt;</font>
                  <font color="#990000">&lt;/</font>tr<font color="#990000">&gt;</font>
                <font color="#990000">)</font>
              <font color="#FF0000">}</font>
              <font color="#990000">)</font><font color="#FF0000">}</font>
            <font color="#990000">&lt;/</font>tbody<font color="#990000">&gt;</font>
          <font color="#990000">&lt;/</font>table<font color="#990000">&gt;</font>
        <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font> <font color="#990000">:</font> <b><font color="#0000FF">null</font></b><font color="#FF0000">}</font>
      <font color="#990000">&lt;</font>div className<font color="#990000">=</font><font color="#FF0000">"key_ops"</font><font color="#990000">&gt;</font>
        <font color="#990000">&lt;</font>div id<font color="#990000">=</font><font color="#FF0000">"key_export"</font><font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>h3<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'key export header'</font><font color="#990000">&gt;</font>Export Keys<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>h3<font color="#990000">&gt;</font>
          <font color="#FF0000">{</font>Object<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">(</font>data<font color="#990000">[</font><font color="#FF0000">'roomMetadata'</font><font color="#990000">]).</font>length <font color="#990000">&gt;</font> <font color="#993399">0</font> <font color="#990000">||</font> Object<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">(</font>data<font color="#990000">[</font><font color="#FF0000">'contacts'</font><font color="#990000">]).</font>length <font color="#990000">&gt;</font> <font color="#993399">0</font> <font color="#990000">||</font> Object<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">(</font>data<font color="#990000">[</font><font color="#FF0000">'roomData'</font><font color="#990000">]).</font>length <font color="#990000">&gt;</font> <font color="#993399">0</font> <font color="#990000">?</font> <font color="#990000">&lt;</font>div<font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>label htmlFor<font color="#990000">=</font><font color="#FF0000">'keyFile_name'</font> style<font color="#990000">=</font><font color="#FF0000">{{</font> fontSize<font color="#990000">:</font> <font color="#FF0000">"16px"</font> <font color="#FF0000">}}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'key export filename label'</font><font color="#990000">&gt;</font>Enter filename you want to save as<font color="#990000">:&amp;</font>emsp<font color="#990000">;&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>label<font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">'text'</font> id<font color="#990000">=</font><font color="#FF0000">'keyFile_name'</font> defaultValue<font color="#990000">=</font><font color="#FF0000">'SnackabraData'</font> onFocus<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">(</font>e<font color="#990000">)</font> <font color="#990000">=&gt;</font> e<font color="#990000">.</font>target<font color="#990000">.</font><b><font color="#000000">select</font></b><font color="#990000">()</font><font color="#FF0000">}</font><font color="#990000">&gt;&lt;/</font>input<font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button gray-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">()</font> <font color="#990000">=&gt;</font> <b><font color="#000000">downloadFile</font></b><font color="#990000">(</font>JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>data<font color="#990000">),</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'keyFile_name'</font><font color="#990000">).</font>value <font color="#990000">+</font> <font color="#FF0000">'.txt'</font><font color="#990000">)</font><font color="#FF0000">}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'Download LS data button'</font><font color="#990000">&gt;</font>Download Data<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>button<font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button gray-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">()</font> <font color="#990000">=&gt;</font> <b><font color="#000000">exportPemKeys</font></b><font color="#990000">()</font><font color="#FF0000">}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'Convert to PEM button'</font><font color="#990000">&gt;</font>Convert to PEM<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>button<font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>p<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'copy paste ls message'</font><font color="#990000">&gt;</font>You can also copy<font color="#990000">-</font>paste the following<font color="#990000">:&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>p<font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>textarea rows<font color="#990000">=</font><font color="#FF0000">{</font><font color="#993399">10</font><font color="#FF0000">}</font> id<font color="#990000">=</font><font color="#FF0000">"key_export_ta"</font> defaultValue<font color="#990000">=</font><font color="#FF0000">{</font>JSON<font color="#990000">.</font><b><font color="#000000">stringify</font></b><font color="#990000">(</font>data<font color="#990000">,</font> undefined<font color="#990000">,</font> <font color="#993399">2</font><font color="#990000">)</font><font color="#FF0000">}</font><font color="#990000">&gt;&lt;/</font>textarea<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font><font color="#FF6600">/div&gt; : &lt;Trans id='key export ls empty message'&gt;Your localstorage does not have any data to export!&lt;/</font>Trans<font color="#990000">&gt;</font><font color="#FF0000">}</font>
        <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font>
        <font color="#990000">&lt;</font>div id<font color="#990000">=</font><font color="#FF0000">"key_import"</font><font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>h3<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'key import header'</font><font color="#990000">&gt;</font>Import Keys<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>h3<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>div<font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">"file"</font> id<font color="#990000">=</font><font color="#FF0000">"importKeyFile"</font> name<font color="#990000">=</font><font color="#FF0000">"file-input"</font> onChange<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">()</font> <font color="#990000">=&gt;</font> <font color="#FF0000">{</font>
              document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_import_ta"</font><font color="#990000">).</font>value <font color="#990000">=</font> <font color="#FF0000">"Selecting file...."</font>
              <b><font color="#0000FF">const</font></b> reader <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">FileReader</font></b><font color="#990000">()</font>
              reader<font color="#990000">.</font>onload <font color="#990000">=</font> event <font color="#990000">=&gt;</font> <font color="#FF0000">{</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_import_ta"</font><font color="#990000">).</font>value <font color="#990000">=</font> event<font color="#990000">.</font>target<font color="#990000">.</font>result <font color="#FF0000">}</font> <i><font color="#9A1900">// desired file content</font></i>
              reader<font color="#990000">.</font>onerror <font color="#990000">=</font> error <font color="#990000">=&gt;</font> <font color="#FF0000">{</font> console<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>error<font color="#990000">);</font> document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">"key_import_ta"</font><font color="#990000">).</font>value <font color="#990000">=</font> <font color="#FF0000">'Error importing file! Please try again.'</font> <font color="#FF0000">}</font>
              reader<font color="#990000">.</font><b><font color="#000000">readAsText</font></b><font color="#990000">(</font>document<font color="#990000">.</font><b><font color="#000000">getElementById</font></b><font color="#990000">(</font><font color="#FF0000">'importKeyFile'</font><font color="#990000">).</font>files<font color="#990000">[</font><font color="#993399">0</font><font color="#990000">]);</font>
            <font color="#FF0000">}}</font> <font color="#990000">/&gt;</font>
            <font color="#990000">&lt;</font>p<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'key import paste message'</font><font color="#990000">&gt;</font>Or paste the keys you want to import<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>p<font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>textarea rows<font color="#990000">=</font><font color="#FF0000">{</font><font color="#993399">5</font><font color="#FF0000">}</font> id<font color="#990000">=</font><font color="#FF0000">"key_import_ta"</font> onFocus<font color="#990000">=</font><font color="#FF0000">{</font><font color="#990000">(</font>e<font color="#990000">)</font> <font color="#990000">=&gt;</font> e<font color="#990000">.</font>target<font color="#990000">.</font><b><font color="#000000">select</font></b><font color="#990000">()</font><font color="#FF0000">}</font> defaultValue<font color="#990000">=</font><font color="#FF0000">{</font><font color="#FF0000">"No file selected"</font><font color="#FF0000">}</font><font color="#990000">&gt;&lt;/</font>textarea<font color="#990000">&gt;</font>
            <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
            <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button gray-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font>importFile<font color="#FF0000">}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'key import header'</font><font color="#990000">&gt;</font>Import Keys<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>button<font color="#990000">&gt;</font>
          <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font>
        <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font>
      <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font>
      <font color="#990000">&lt;</font>div id<font color="#990000">=</font><font color="#FF0000">"server_admin"</font><font color="#990000">&gt;</font>
        <font color="#990000">&lt;</font>div id<font color="#990000">=</font><font color="#FF0000">"uploadRoom"</font><font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>h3<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'room upload header'</font><font color="#990000">&gt;</font>Upload<font color="#990000">/</font>Create Room<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>h3<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>p<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'room upload message'</font><font color="#990000">&gt;</font>You can upload room data <b><font color="#0000FF">for</font></b> a previously generated room or create a <b><font color="#0000FF">new</font></b> room by entering your room server secret and pressing the button below<font color="#990000">.</font> Creating a <b><font color="#0000FF">new</font></b> room will generate the necessary keys <b><font color="#0000FF">for</font></b> the <b><font color="#0000FF">new</font></b> room and initialize the room <b><font color="#0000FF">for</font></b> you on your server<font color="#990000">.&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>p<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font> <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">"file"</font> id<font color="#990000">=</font><font color="#FF0000">"uploadRoomFile"</font> name<font color="#990000">=</font><font color="#FF0000">"file-input"</font> <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font> <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>label htmlFor<font color="#990000">=</font><font color="#FF0000">'serverSecretInput'</font><font color="#990000">&gt;</font>Enter Room Server Secret<font color="#990000">:</font> <font color="#990000">&lt;/</font>label<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">"text"</font> id<font color="#990000">=</font><font color="#FF0000">"serverSecretInput"</font><font color="#990000">&gt;&lt;/</font>input<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button gray-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font>uploadRoomData<font color="#FF0000">}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'room upload button'</font><font color="#990000">&gt;</font>Upload Room Data<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>button<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button gray-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font>createNewRoom<font color="#FF0000">}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'new room button'</font><font color="#990000">&gt;</font>Create New Room<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>button<font color="#990000">&gt;</font>
        <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font>
        <font color="#990000">&lt;</font>div id<font color="#990000">=</font><font color="#FF0000">"uploadStorage"</font><font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>h3<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'storage upload header'</font><font color="#990000">&gt;</font>Upload Storage Data<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>h3<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>p<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'storage upload message'</font><font color="#990000">&gt;</font>You can upload storage data <b><font color="#0000FF">for</font></b> a previously generated room by entering your storage server secret and pressing the button below<font color="#990000">.&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>p<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font> <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">"file"</font> id<font color="#990000">=</font><font color="#FF0000">"uploadStorageFile"</font> name<font color="#990000">=</font><font color="#FF0000">"file-input"</font> <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font> <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>label htmlFor<font color="#990000">=</font><font color="#FF0000">'storageServerSecretInput'</font><font color="#990000">&gt;</font>Enter Storage Server Secret<font color="#990000">:</font> <font color="#990000">&lt;/</font>label<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">"text"</font> id<font color="#990000">=</font><font color="#FF0000">"storageServerSecretInput"</font><font color="#990000">&gt;&lt;/</font>input<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button gray-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font>uploadStorageData<font color="#FF0000">}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'storage upload button'</font><font color="#990000">&gt;</font>Upload Storage Data<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>button<font color="#990000">&gt;</font>
        <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font>
        <font color="#990000">&lt;</font>div id<font color="#990000">=</font><font color="#FF0000">"authorizeRoom"</font><font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>h3<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'room authorize header'</font><font color="#990000">&gt;</font>Authorize Room<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>h3<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>p<font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'room authorize message'</font><font color="#990000">&gt;</font>You can authorize a room to be made available on your server<font color="#990000">.</font> To <b><font color="#0000FF">do</font></b> that<font color="#990000">,</font> enter the roomId<font color="#990000">,</font> the <b><font color="#0000FF">public</font></b> key of the room owner and your server secret and press Authorize Room<font color="#990000">.&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>p<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font> <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>label htmlFor<font color="#990000">=</font><font color="#FF0000">'authorizeRoomServerSecretInput'</font><font color="#990000">&gt;</font>Enter Room Server Secret<font color="#990000">:</font> <font color="#990000">&lt;/</font>label<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">"text"</font> id<font color="#990000">=</font><font color="#FF0000">"authorizeRoomServerSecretInput"</font><font color="#990000">&gt;&lt;/</font>input<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font> <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>label htmlFor<font color="#990000">=</font><font color="#FF0000">'authorizeRoomIdInput'</font><font color="#990000">&gt;</font>Enter Room ID<font color="#990000">:</font> <font color="#990000">&lt;/</font>label<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">"text"</font> id<font color="#990000">=</font><font color="#FF0000">"authorizeRoomIdInput"</font><font color="#990000">&gt;&lt;/</font>input<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font> <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>label htmlFor<font color="#990000">=</font><font color="#FF0000">'authorizeOwnerInput'</font><font color="#990000">&gt;</font>Enter Room Owner Public Key<font color="#990000">:</font> <font color="#990000">&lt;/</font>label<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>input type<font color="#990000">=</font><font color="#FF0000">"text"</font> id<font color="#990000">=</font><font color="#FF0000">"authorizeRoomOwnerInput"</font><font color="#990000">&gt;&lt;/</font>input<font color="#990000">&gt;</font>
          <font color="#990000">&lt;</font>br <font color="#990000">/&gt;</font>
          <font color="#990000">&lt;</font>button className<font color="#990000">=</font><font color="#FF0000">'admin-button gray-btn'</font> onClick<font color="#990000">=</font><font color="#FF0000">{</font>authorizeRoom<font color="#FF0000">}</font><font color="#990000">&gt;&lt;</font>Trans id<font color="#990000">=</font><font color="#FF0000">'room authorize button'</font><font color="#990000">&gt;</font>Authorize Room<font color="#990000">&lt;</font><font color="#FF6600">/Trans&gt;&lt;/</font>button<font color="#990000">&gt;</font>
        <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font>
      <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font>
    <font color="#990000">&lt;/</font>div<font color="#990000">&gt;</font>
  <font color="#990000">)</font>
<font color="#FF0000">}</font>

<b><font color="#0000FF">export</font></b> <b><font color="#0000FF">default</font></b> LandingPage<font color="#990000">;</font>
</tt></pre>
